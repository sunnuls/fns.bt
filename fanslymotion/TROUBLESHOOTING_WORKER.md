# üîß –†–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º —Å Worker

## –ü—Ä–æ–±–ª–µ–º–∞: AbandonedJobError

**–°–∏–º–ø—Ç–æ–º—ã:**
- Job —Å–æ–∑–¥–∞–µ—Ç—Å—è –∏ –ø–æ–ø–∞–¥–∞–µ—Ç –≤ –æ—á–µ—Ä–µ–¥—å ‚úÖ
- Worker –Ω–∞—á–∏–Ω–∞–µ—Ç –æ–±—Ä–∞–±–æ—Ç–∫—É ‚úÖ
- –ù–æ –∑–∞—Ç–µ–º: "AbandonedJobError" ‚ùå
- GPU –Ω–µ –Ω–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –∏–ª–∏ –ø–∞–¥–∞–µ—Ç –¥–æ 10%

## –ü—Ä–∏—á–∏–Ω—ã:

### 1. Worker –ø–∞–¥–∞–µ—Ç –ø—Ä–∏ –∏–º–ø–æ—Ä—Ç–µ –º–æ–¥—É–ª–µ–π
**–†–µ—à–µ–Ω–∏–µ:** –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –æ–∫–Ω–æ Worker - –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –ª–æ–≥–∏ –∏–º–ø–æ—Ä—Ç–∞

### 2. Worker –ø–∞–¥–∞–µ—Ç –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –º–æ–¥–µ–ª–∏ (OOM)
**–†–µ—à–µ–Ω–∏–µ:** 
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ 720p –≤–º–µ—Å—Ç–æ 1080p
- –í–∫–ª—é—á–µ–Ω CPU offload (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –¥–ª—è <16GB VRAM)

### 3. Worker —Ç–∞–π–º–∞—É—Ç–∏—Ç—Å—è (Windows SimpleWorker)
**–†–µ—à–µ–Ω–∏–µ:**
- –¢–∞–π–º–∞—É—Ç—ã —É–≤–µ–ª–∏—á–µ–Ω—ã –¥–æ 600s (10 –º–∏–Ω—É—Ç)
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è NoOp death penalty

### 4. –û—à–∏–±–∫–∏ –≤ –ø—Ä–æ—Ü–µ—Å—Å–µ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏
**–†–µ—à–µ–Ω–∏–µ:** –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ worker –Ω–∞ –Ω–∞–ª–∏—á–∏–µ ERROR

## –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞:

### –®–∞–≥ 1: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ Worker –æ–∫–Ω–æ

–ü–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞ –∑–∞–¥–∞–Ω–∏—è –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å:

```
[WORKER] Starting job: ...
[WORKER] Job func: worker.tasks.process_video_generation
[START] Job ...
[DEBUG] Metadata loaded...
[INFO] Getting renderer...
```

**–ï—Å–ª–∏ –ª–æ–≥–æ–≤ –Ω–µ—Ç –ø–æ—Å–ª–µ `[WORKER] Starting job` ‚Üí**
- Worker –ø–∞–¥–∞–µ—Ç –ø—Ä–∏ –∏–º–ø–æ—Ä—Ç–µ
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –æ—à–∏–±–∫–∏ –≤—ã—à–µ

**–ï—Å–ª–∏ –≤–∏–¥–∏—Ç–µ `[INFO] Getting renderer...` –Ω–æ –¥–∞–ª—å—à–µ –Ω–∏—á–µ–≥–æ ‚Üí**
- –ü–∞–¥–∞–µ—Ç –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –º–æ–¥–µ–ª–∏
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ VRAM –∏ –æ—à–∏–±–∫–∏

### –®–∞–≥ 2: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ GPU

```powershell
nvidia-smi -l 1
```

**–û–∂–∏–¥–∞–µ–º–æ–µ:**
- 0% ‚Üí 50-60% (–º–æ–¥–µ–ª—å) ‚Üí 80-100% (–≥–µ–Ω–µ—Ä–∞—Ü–∏—è) ‚Üí 0%
- –ï—Å–ª–∏ GPU –Ω–µ –ø–æ–¥–Ω–∏–º–∞–µ—Ç—Å—è ‚Üí –º–æ–¥–µ–ª—å –Ω–µ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è

### –®–∞–≥ 3: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏

–í Worker –æ–∫–Ω–µ –Ω–∞–π–¥–∏—Ç–µ —Å—Ç—Ä–æ–∫–∏ —Å:
- `[ERROR]` - –æ—à–∏–±–∫–∏
- `[WARN]` - –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è
- `Traceback` - —Å—Ç–µ–∫ –≤—ã–∑–æ–≤–æ–≤ –ø—Ä–∏ –æ—à–∏–±–∫–µ

## –ë—ã—Å—Ç—Ä–æ–µ —Ä–µ—à–µ–Ω–∏–µ:

### –ï—Å–ª–∏ Worker –Ω–µ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç:

1. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ Worker –∑–∞–ø—É—â–µ–Ω:**
```powershell
Get-Process python | Where-Object { try { $proc = Get-WmiObject Win32_Process -Filter "ProcessId = $($_.Id)"; $proc.CommandLine -like "*worker*" } catch { $false } }
```

2. **–ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ Worker:**
```powershell
.\restart_worker.ps1
```

3. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ Redis:**
```powershell
python -c "import redis; r = redis.Redis(); print('Redis OK' if r.ping() else 'Redis FAILED')"
```

### –ï—Å–ª–∏ GPU –Ω–µ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è:

1. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ CUDA:**
```powershell
python -c "import torch; print('CUDA:', torch.cuda.is_available())"
```

2. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –º–æ–¥–µ–ª—å:**
```powershell
python -c "from svd.renderer import get_renderer; r = get_renderer(); r.load_model()"
```

3. **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –º–µ–Ω—å—à–∏–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏:**
- –†–∞–∑—Ä–µ—à–µ–Ω–∏–µ: 720p (–Ω–µ 1080p)
- –î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å: 6s (–Ω–µ 12s)
- Quality: Standard (–Ω–µ Smooth)

## –¢–∏–ø–∏—á–Ω—ã–µ –æ—à–∏–±–∫–∏:

### "Out of Memory" –∏–ª–∏ "CUDA OOM"
**–†–µ—à–µ–Ω–∏–µ:**
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ 720p –∏–ª–∏ 480p
- –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ CPU offload –≤–∫–ª—é—á–µ–Ω
- –ó–∞–∫—Ä–æ–π—Ç–µ –¥—Ä—É–≥–∏–µ GPU –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

### "Module not found: worker.tasks"
**–†–µ—à–µ–Ω–∏–µ:**
- –ó–∞–ø—É—Å–∫–∞–π—Ç–µ worker –∏–∑ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ `fanslymotion`
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ `worker/tasks.py` —Å—É—â–µ—Å—Ç–≤—É–µ—Ç

### "Model loading timeout"
**–†–µ—à–µ–Ω–∏–µ:**
- –ü–µ—Ä–≤–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ –º–æ–∂–µ—Ç –∑–∞–Ω—è—Ç—å 5-10 –º–∏–Ω—É—Ç
- –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ –º–æ–¥–µ–ª—å —Å–∫–∞—á–∞–Ω–∞ (–ø—Ä–æ–≤–µ—Ä—å—Ç–µ `cache/models/`)

---

**–ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ: `.\restart_worker.ps1`**

