# –†–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º FanslyMotion

## üî¥ –ë–æ—Ç –Ω–µ —Ä–µ–∞–≥–∏—Ä—É–µ—Ç –Ω–∞ /start

### –°–∏–º–ø—Ç–æ–º—ã:
- –í—ã –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç–µ `/start`, –Ω–æ –±–æ—Ç –Ω–µ –æ—Ç–≤–µ—á–∞–µ—Ç
- –ë–æ—Ç "–∑–∞—Å—Ç—Ä—è–ª" –≤ —Å–æ—Å—Ç–æ—è–Ω–∏–∏ –æ–∂–∏–¥–∞–Ω–∏—è —Ñ–æ—Ç–æ
- –ü–æ–≤—Ç–æ—Ä–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã `/start` –∏–≥–Ω–æ—Ä–∏—Ä—É—é—Ç—Å—è

### –ü—Ä–∏—á–∏–Ω–∞:
–ë–æ—Ç –∑–∞–≤–∏—Å –≤ —Å–æ—Å—Ç–æ—è–Ω–∏–∏ FSM (Finite State Machine) –∏ –Ω–µ –º–æ–∂–µ—Ç –≤—ã–π—Ç–∏ –∏–∑ –Ω–µ–≥–æ.

### –†–µ—à–µ–Ω–∏–µ:

**–í–∞—Ä–∏–∞–Ω—Ç 1: –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å –±–æ—Ç–∞ (–±—ã—Å—Ç—Ä–æ)**
```powershell
# –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å Python –ø—Ä–æ—Ü–µ—Å—Å—ã
Get-Process python | Where-Object { $_.Path -like "*fanslymotion*" } | Stop-Process -Force

# –ü–æ–¥–æ–∂–¥–∞—Ç—å 2 —Å–µ–∫—É–Ω–¥—ã
Start-Sleep 2

# –ó–∞–ø—É—Å—Ç–∏—Ç—å –∑–∞–Ω–æ–≤–æ (–æ—Ç–∫—Ä–æ–µ—Ç—Å—è 3 –æ–∫–Ω–∞)
cd C:\fns_bot\fanslymotion
.\run_local_clean.ps1
```

**–í–∞—Ä–∏–∞–Ω—Ç 2: –û—Ç–ø—Ä–∞–≤–∏—Ç—å /cancel (–µ—Å–ª–∏ –±–æ—Ç —Ä–µ–∞–≥–∏—Ä—É–µ—Ç)**
–ù–µ–∫–æ—Ç–æ—Ä—ã–µ –±–æ—Ç—ã –∏–º–µ—é—Ç –∫–æ–º–∞–Ω–¥—É –æ—Ç–º–µ–Ω—ã. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ:
```
/cancel
```

**–í–∞—Ä–∏–∞–Ω—Ç 3: –ù–∞–∂–∞—Ç—å –∫–Ω–æ–ø–∫—É "Cancel"**
–ï—Å–ª–∏ –±–æ—Ç –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∫–Ω–æ–ø–∫—É ‚ùå Cancel - –Ω–∞–∂–º–∏—Ç–µ –µ—ë.

**–í–∞—Ä–∏–∞–Ω—Ç 4: –ù–∞–∂–∞—Ç—å "Back to Menu"**
–ï—Å–ª–∏ –µ—Å—Ç—å –∫–Ω–æ–ø–∫–∞ ‚óÄÔ∏è Back to Menu - –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –µ—ë.

---

## üî¥ Backend –Ω–µ –æ—Ç–≤–µ—á–∞–µ—Ç

### –°–∏–º–ø—Ç–æ–º—ã:
- –ë–æ—Ç –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç "Submitting job to server..."
- –ó–∞–¥–∞—á–∞ –Ω–µ —Å–æ–∑–¥–∞—ë—Ç—Å—è
- –û—à–∏–±–∫–∞ "Connection failed"

### –†–µ—à–µ–Ω–∏–µ:

**–®–∞–≥ 1: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å Backend**
```powershell
curl http://127.0.0.1:8000/health
```

–î–æ–ª–∂–Ω–æ –≤–µ—Ä–Ω—É—Ç—å:
```json
{"status":"healthy","redis":"connected","queue_length":0}
```

**–®–∞–≥ 2: –ï—Å–ª–∏ Backend –Ω–µ –æ—Ç–≤–µ—á–∞–µ—Ç**
–ü—Ä–æ–≤–µ—Ä—å—Ç–µ, –æ—Ç–∫—Ä—ã—Ç–æ –ª–∏ –æ–∫–Ω–æ "BACKEND API" (–∑–µ–ª—ë–Ω–æ–µ).
–ï—Å–ª–∏ –Ω–µ—Ç - –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ:
```powershell
cd C:\fns_bot\fanslymotion
.\venv\Scripts\Activate.ps1
python -m uvicorn backend.app:app --host 0.0.0.0 --port 8000
```

---

## üî¥ Redis –Ω–µ –ø–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è

### –°–∏–º–ø—Ç–æ–º—ã:
- Health endpoint –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç: `"status":"unhealthy"`
- –û—à–∏–±–∫–∞: `"redis":"Connection refused"`

### –†–µ—à–µ–Ω–∏–µ:

**–®–∞–≥ 1: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å Redis**
```powershell
cd C:\Redis-x64-3.0.504
.\redis-cli.exe ping
```

–î–æ–ª–∂–Ω–æ –≤–µ—Ä–Ω—É—Ç—å: `PONG`

**–®–∞–≥ 2: –ï—Å–ª–∏ Redis –Ω–µ –æ—Ç–≤–µ—á–∞–µ—Ç**
–ó–∞–ø—É—Å—Ç–∏—Ç–µ Redis:
```powershell
cd C:\Redis-x64-3.0.504
.\redis-server.exe
```

–û—Å—Ç–∞–≤—å—Ç–µ –æ–∫–Ω–æ –æ—Ç–∫—Ä—ã—Ç—ã–º!

---

## üî¥ Worker –Ω–µ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –∑–∞–¥–∞—á–∏

### –°–∏–º–ø—Ç–æ–º—ã:
- –ó–∞–¥–∞—á–∞ —Å–æ–∑–¥–∞—ë—Ç—Å—è
- –ü—Ä–æ–≥—Ä–µ—Å—Å –Ω–µ –∏–¥—ë—Ç
- –ó–∞—Å—Ç—Ä—è–ª–æ –Ω–∞ "Queue position: X"

### –†–µ—à–µ–Ω–∏–µ:

**–®–∞–≥ 1: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å Worker**
–û—Ç–∫—Ä–æ–π—Ç–µ –æ–∫–Ω–æ "RQ WORKER" (–∂—ë–ª—Ç–æ–µ) –∏ –ø–æ—Å–º–æ—Ç—Ä–∏—Ç–µ –Ω–∞ –æ—à–∏–±–∫–∏.

**–®–∞–≥ 2: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –º–æ–¥–µ–ª—å AI**
–ï—Å–ª–∏ –ø–µ—Ä–≤—ã–π –∑–∞–ø—É—Å–∫ - –º–æ–¥–µ–ª—å —Å–∫–∞—á–∏–≤–∞–µ—Ç—Å—è (10-30 –º–∏–Ω—É—Ç).
–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–∞–ø–∫—É:
```powershell
dir C:\AI-cache\huggingface\hub
```

**–®–∞–≥ 3: –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å Worker**
```powershell
cd C:\fns_bot\fanslymotion
.\venv\Scripts\Activate.ps1
python worker/worker.py
```

---

## üî¥ "Technical error. Credits refunded"

### –í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–∏—á–∏–Ω—ã:

**1. PyTorch –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω**
```powershell
cd C:\fns_bot\fanslymotion
.\venv\Scripts\Activate.ps1
pip install torch torchvision --index-url https://download.pytorch.org/whl/cu121
```

**2. Diffusers –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω**
```powershell
pip install diffusers transformers accelerate
```

**3. –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ VRAM**
–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –º–µ–Ω—å—à–µ–µ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ (360p –∏–ª–∏ 480p).

**4. CUDA –Ω–µ –¥–æ—Å—Ç—É–ø–Ω–∞**
–ü—Ä–æ–≤–µ—Ä—å—Ç–µ:
```powershell
nvidia-smi
```

–î–æ–ª–∂–Ω–∞ –ø–æ–∫–∞–∑–∞—Ç—å –≤–∞—à—É –≤–∏–¥–µ–æ–∫–∞—Ä—Ç—É.

---

## üî¥ –í—Å–µ –æ–∫–Ω–∞ –∑–∞–∫—Ä—ã–ª–∏—Å—å

### –ü—Ä–∏—á–∏–Ω–∞:
–ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞ –≤ –æ–¥–Ω–æ–º –∏–∑ —Å–µ—Ä–≤–∏—Å–æ–≤.

### –†–µ—à–µ–Ω–∏–µ:

**–ó–∞–ø—É—Å—Ç–∏—Ç–µ –∫–∞–∂–¥—ã–π —Å–µ—Ä–≤–∏—Å –≤—Ä—É—á–Ω—É—é** –≤ –æ—Ç–¥–µ–ª—å–Ω—ã—Ö –æ–∫–Ω–∞—Ö:

**–û–∫–Ω–æ 1 - Redis:**
```powershell
cd C:\Redis-x64-3.0.504
.\redis-server.exe
```

**–û–∫–Ω–æ 2 - Backend:**
```powershell
cd C:\fns_bot\fanslymotion
.\venv\Scripts\Activate.ps1
python -m uvicorn backend.app:app --host 0.0.0.0 --port 8000
```

**–û–∫–Ω–æ 3 - Bot:**
```powershell
cd C:\fns_bot\fanslymotion
.\venv\Scripts\Activate.ps1
python bot/bot.py
```

**–û–∫–Ω–æ 4 - Worker:**
```powershell
cd C:\fns_bot\fanslymotion
.\venv\Scripts\Activate.ps1
python worker/worker.py
```

–°–º–æ—Ç—Ä–∏—Ç–µ –Ω–∞ –æ—à–∏–±–∫–∏ –≤ –∫–∞–∂–¥–æ–º –æ–∫–Ω–µ!

---

## üî¥ –î–æ–ª–≥–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞

### –ù–æ—Ä–º–∞–ª—å–Ω–æ:
- **–ü–µ—Ä–≤—ã–π –∑–∞–ø—É—Å–∫**: 10-30 –º–∏–Ω—É—Ç (—Å–∫–∞—á–∏–≤–∞–Ω–∏–µ –º–æ–¥–µ–ª–∏)
- **360p, 6s**: ~1 –º–∏–Ω—É—Ç–∞
- **480p, 6s**: ~2 –º–∏–Ω—É—Ç—ã
- **720p, 6s**: ~3-5 –º–∏–Ω—É—Ç
- **1080p, 6s**: ~5-10 –º–∏–Ω—É—Ç

### –ï—Å–ª–∏ –¥–æ–ª—å—à–µ:
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ Worker - –µ—Å—Ç—å –ª–∏ –æ—à–∏–±–∫–∏?
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ GPU: `nvidia-smi`
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ VRAM –Ω–µ –ø–µ—Ä–µ–ø–æ–ª–Ω–µ–Ω–∞?

---

## üî¥ –ü–æ—Ä—Ç 8000 –∑–∞–Ω—è—Ç

### –°–∏–º–ø—Ç–æ–º—ã:
```
Error: [Errno 10048] address already in use
```

### –†–µ—à–µ–Ω–∏–µ:

**–ù–∞–π—Ç–∏ –ø—Ä–æ—Ü–µ—Å—Å:**
```powershell
netstat -ano | findstr :8000
```

**–£–±–∏—Ç—å –ø—Ä–æ—Ü–µ—Å—Å:**
```powershell
Stop-Process -Id <PID> -Force
```

–ò–ª–∏ –∏–∑–º–µ–Ω–∏—Ç–µ –ø–æ—Ä—Ç –≤ `.env`:
```ini
BACKEND_PORT=8001
```

---

## üî¥ –ë–æ—Ç –Ω–µ –≤–∏–¥–∏—Ç —Ñ–æ—Ç–æ

### –ü—Ä–æ–±–ª–µ–º–∞:
–í—ã –æ—Ç–ø—Ä–∞–≤–∏–ª–∏ —Ñ–æ—Ç–æ, –Ω–æ –±–æ—Ç –Ω–µ —Ä–µ–∞–≥–∏—Ä—É–µ—Ç.

### –ü—Ä–∏—á–∏–Ω–∞:
–í—ã –Ω–µ –ø—Ä–æ—à–ª–∏ –≤—Å–µ —à–∞–≥–∏ –≤—ã–±–æ—Ä–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤!

### –†–µ—à–µ–Ω–∏–µ:
–ù—É–∂–Ω–æ –ø—Ä–æ–π—Ç–∏ **–í–°–ï** —à–∞–≥–∏:
1. `/start`
2. –ö–Ω–æ–ø–∫–∞ "üì∏ photo‚Üívideo üé¶"
3. –í—ã–±—Ä–∞—Ç—å –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
4. –í—ã–±—Ä–∞—Ç—å —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ
5. –í—ã–±—Ä–∞—Ç—å –¥–≤–∏–∂–µ–Ω–∏–µ
6. **–¢–û–õ–¨–ö–û –ü–û–¢–û–ú** –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å —Ñ–æ—Ç–æ!

---

## üõ†Ô∏è –ü–æ–ª–Ω—ã–π —Å–±—Ä–æ—Å —Å–∏—Å—Ç–µ–º—ã

–ï—Å–ª–∏ –Ω–∏—á–µ–≥–æ –Ω–µ –ø–æ–º–æ–≥–∞–µ—Ç:

```powershell
# 1. –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –≤—Å—ë
Get-Process python,redis-server -ErrorAction SilentlyContinue | Stop-Process -Force

# 2. –û—á–∏—Å—Ç–∏—Ç—å –æ—á–µ—Ä–µ–¥—å Redis
cd C:\Redis-x64-3.0.504
.\redis-cli.exe FLUSHALL

# 3. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å –≤—Å—ë
cd C:\fns_bot\fanslymotion

# –ó–∞–ø—É—Å—Ç–∏—Ç—å Redis
cd C:\Redis-x64-3.0.504
Start-Process powershell -ArgumentList "-NoExit","-Command",".\redis-server.exe"

# –ó–∞–ø—É—Å—Ç–∏—Ç—å —Å–µ—Ä–≤–∏—Å—ã
cd C:\fns_bot\fanslymotion
.\run_local_clean.ps1
```

---

## üìä –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ —Å–∏—Å—Ç–µ–º—ã

**–ë—ã—Å—Ç—Ä–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞:**
```powershell
# Redis —Ä–∞–±–æ—Ç–∞–µ—Ç?
redis-cli ping

# Backend —Ä–∞–±–æ—Ç–∞–µ—Ç?
curl http://127.0.0.1:8000/health

# –°–∫–æ–ª—å–∫–æ –∑–∞–¥–∞—á –≤ –æ—á–µ—Ä–µ–¥–∏?
redis-cli llen svd_jobs

# –ö–∞–∫–∏–µ –ø—Ä–æ—Ü–µ—Å—Å—ã Python –∑–∞–ø—É—â–µ–Ω—ã?
Get-Process python | Where-Object { $_.Path -like "*fanslymotion*" }
```

---

## üí° –°–æ–≤–µ—Ç—ã

1. **–ù–µ –∑–∞–∫—Ä—ã–≤–∞–π—Ç–µ –æ–∫–Ω–∞** –ø–æ–∫–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç–µ —Å –±–æ—Ç–æ–º
2. **–°–º–æ—Ç—Ä–∏—Ç–µ –Ω–∞ –ª–æ–≥–∏** –≤ –æ–∫–Ω–∞—Ö - —Ç–∞–º –≤–∏–¥–Ω—ã –æ—à–∏–±–∫–∏
3. **–ù–∞—á–Ω–∏—Ç–µ —Å –º–∞–ª–æ–≥–æ**: 480p, 6s, micro movement
4. **–ü–µ—Ä–≤—ã–π –∑–∞–ø—É—Å–∫ –¥–æ–ª–≥–∏–π** - —ç—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ (—Å–∫–∞—á–∏–≤–∞–Ω–∏–µ –º–æ–¥–µ–ª–∏)
5. **–°–æ—Ö—Ä–∞–Ω—è–π—Ç–µ –ø–æ—Ä—è–¥–æ–∫**: Redis ‚Üí Backend ‚Üí Worker ‚Üí Bot

---

–ï—Å–ª–∏ –ø—Ä–æ–±–ª–µ–º–∞ –Ω–µ —Ä–µ—à–µ–Ω–∞ - –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –≤ –æ–∫–Ω–∞—Ö —Å–µ—Ä–≤–∏—Å–æ–≤!

