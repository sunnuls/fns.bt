# –ö–∞–∫ –æ—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å —Ä–∞–±–æ—Ç—É —Å–∏—Å—Ç–µ–º—ã

## ü™ü –ö–∞–∫–∏–µ –æ–∫–Ω–∞ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –æ—Ç–∫—Ä—ã—Ç—ã?

–£ –≤–∞—Å –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å **4 –æ–∫–Ω–∞ PowerShell**:

### 1. **REDIS SERVER** (–∫—Ä–∞—Å–Ω–æ–µ/–±–µ–ª–æ–µ)
```
[PID] Redis Server v3.0.504
The server is now ready to accept connections on port 6379
```
**–ß—Ç–æ —ç—Ç–æ:** –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –æ—á–µ—Ä–µ–¥–∏ –∑–∞–¥–∞—á  
**–î–æ–ª–∂–Ω–æ –±—ã—Ç—å:** –†–∞–±–æ—Ç–∞–µ—Ç –ø–æ—Å—Ç–æ—è–Ω–Ω–æ, –Ω–µ—Ç –æ—à–∏–±–æ–∫

---

### 2. **BACKEND API** (–∑–µ–ª—ë–Ω–æ–µ)
```
INFO:     Uvicorn running on http://0.0.0.0:8000
INFO:     Application startup complete
```
**–ß—Ç–æ —ç—Ç–æ:** API-—Å–µ—Ä–≤–µ—Ä –¥–ª—è —Å–≤—è–∑–∏ –±–æ—Ç–∞ —Å —Å–∏—Å—Ç–µ–º–æ–π  
**–î–æ–ª–∂–Ω–æ –±—ã—Ç—å:** "Application startup complete", –Ω–µ—Ç –∫—Ä–∞—Å–Ω—ã—Ö ERROR

---

### 3. **TELEGRAM BOT** (@LunaMotionBot, –≥–æ–ª—É–±–æ–µ)
```
INFO - Starting FanslyMotion Telegram Bot...
INFO - Start polling
INFO - Run polling for bot @LunaMotionBot
```
**–ß—Ç–æ —ç—Ç–æ:** –í–∞—à Telegram –±–æ—Ç  
**–î–æ–ª–∂–Ω–æ –±—ã—Ç—å:** "Run polling", –Ω–µ—Ç –æ—à–∏–±–æ–∫

---

### 4. **RQ WORKER** (–∂—ë–ª—Ç–æ–µ) ‚≠ê **–°–ê–ú–û–ï –í–ê–ñ–ù–û–ï**
```
Starting RQ Worker for video generation...
Connected to Redis: localhost:6379
Queue: svd_jobs
```
**–ß—Ç–æ —ç—Ç–æ:** –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∑–∞–¥–∞—á, –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä –≤–∏–¥–µ–æ  
**–î–æ–ª–∂–Ω–æ –±—ã—Ç—å:** "Connected to Redis", –∂–¥—ë—Ç –∑–∞–¥–∞—á

---

## üîç –ö–∞–∫ –ø–æ–Ω—è—Ç—å, —á—Ç–æ –º–æ–¥–µ–ª—å —Å–∫–∞—á–∏–≤–∞–µ—Ç—Å—è?

### –ö–æ–≥–¥–∞ –≤—ã –æ—Ç–ø—Ä–∞–≤–∏—Ç–µ –∑–∞–¥–∞—á—É, –≤ –æ–∫–Ω–µ **RQ WORKER** –ø–æ—è–≤–∏—Ç—Å—è:

**1. –ù–∞—á–∞–ª–æ –æ–±—Ä–∞–±–æ—Ç–∫–∏:**
```
Starting job 33e500af-724a-454d-9b66-455f76bfcb06
```

**2. –ó–∞–≥—Ä—É–∑–∫–∞ –º–æ–¥–µ–ª–∏ (–ü–ï–†–í–´–ô –†–ê–ó - –¥–æ–ª–≥–æ!):**
```
Loading SVD model: stabilityai/stable-video-diffusion-img2vid-xt
Downloading (‚Ä¶)del.fp16.safetensors: 0%|          | 0/10.0G [00:00<?, ?B/s]
Downloading (‚Ä¶)del.fp16.safetensors: 1%|‚ñè         | 100M/10.0G [00:30<45:00, 3.5MB/s]
Downloading (‚Ä¶)del.fp16.safetensors: 5%|‚ñå         | 500M/10.0G [02:30<47:30, 3.4MB/s]
```

**–ü—Ä–∏–∑–Ω–∞–∫–∏ —Å–∫–∞—á–∏–≤–∞–Ω–∏—è:**
- ‚úÖ –°—Ç—Ä–æ–∫–∞ "Downloading (...)"
- ‚úÖ –ü—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä —Å –ø—Ä–æ—Ü–µ–Ω—Ç–∞–º–∏: `5%|‚ñå`
- ‚úÖ –°–∫–æ—Ä–æ—Å—Ç—å —Å–∫–∞—á–∏–≤–∞–Ω–∏—è: `3.5MB/s`
- ‚úÖ –û—Å—Ç–∞–≤—à–µ–µ—Å—è –≤—Ä–µ–º—è: `<45:00`

**3. –ü–æ—Å–ª–µ —Å–∫–∞—á–∏–≤–∞–Ω–∏—è (–±—ã—Å—Ç—Ä–æ):**
```
Model loaded on cuda
‚úÖ Generating video: 6s @ 480x640
Running inference with 24 steps, 72 frames...
Saving video to storage/hot/33e500af_output.mp4
‚úÖ Video generated successfully
```

---

## üìä –ö–∞–∫ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–∞–∑–º–µ—Ä —Å–∫–∞—á–∞–Ω–Ω–æ–π –º–æ–¥–µ–ª–∏?

### PowerShell –∫–æ–º–∞–Ω–¥–∞:
```powershell
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–∞–∑–º–µ—Ä –º–æ–¥–µ–ª–∏
$path = "C:\AI-cache\huggingface\hub"
$files = Get-ChildItem $path -Recurse -File
$size = ($files | Measure-Object -Property Length -Sum).Sum / 1GB
Write-Host "Model size: $([math]::Round($size, 2)) GB"

# –î–æ–ª–∂–Ω–æ –±—ã—Ç—å: ~9-10 GB –∫–æ–≥–¥–∞ —Å–∫–∞—á–∞–Ω–∞ –ø–æ–ª–Ω–æ—Å—Ç—å—é
```

### –ë—ã—Å—Ç—Ä–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞:
```powershell
dir C:\AI-cache\huggingface\hub /s
```

**–ï—Å–ª–∏ –ø–∞–ø–∫–∞ –ø—É—Å—Ç–∞—è (< 1 –ì–ë)** - –º–æ–¥–µ–ª—å –Ω–µ —Å–∫–∞—á–∞–Ω–∞  
**–ï—Å–ª–∏ –ø–∞–ø–∫–∞ ~10 –ì–ë** - –º–æ–¥–µ–ª—å —Å–∫–∞—á–∞–Ω–∞

---

## ‚è±Ô∏è –°–∫–æ–ª—å–∫–æ –≤—Ä–µ–º–µ–Ω–∏ –∑–∞–π–º—ë—Ç?

### –ü–µ—Ä–≤—ã–π –∑–∞–ø—É—Å–∫ (—Å–∫–∞—á–∏–≤–∞–Ω–∏–µ –º–æ–¥–µ–ª–∏):
- **–ë—ã—Å—Ç—Ä—ã–π –∏–Ω—Ç–µ—Ä–Ω–µ—Ç (50+ –ú–±–∏—Ç/—Å):** 10-15 –º–∏–Ω—É—Ç
- **–°—Ä–µ–¥–Ω–∏–π –∏–Ω—Ç–µ—Ä–Ω–µ—Ç (20-50 –ú–±–∏—Ç/—Å):** 20-30 –º–∏–Ω—É—Ç
- **–ú–µ–¥–ª–µ–Ω–Ω—ã–π –∏–Ω—Ç–µ—Ä–Ω–µ—Ç (< 20 –ú–±–∏—Ç/—Å):** 40-60 –º–∏–Ω—É—Ç

### –ü–æ—Å–ª–µ —Å–∫–∞—á–∏–≤–∞–Ω–∏—è –º–æ–¥–µ–ª–∏:
- **360p, 6s:** ~1 –º–∏–Ω—É—Ç–∞
- **480p, 6s:** ~2 –º–∏–Ω—É—Ç—ã
- **720p, 6s:** ~3-4 –º–∏–Ω—É—Ç—ã
- **1080p, 6s:** ~5-7 –º–∏–Ω—É—Ç

---

## üö® –¢–∏–ø–∏—á–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã –≤ –æ–∫–Ω–µ RQ WORKER

### ‚ùå "Connection refused"
```
redis.exceptions.ConnectionError: Error 10061
```
**–ü—Ä–∏—á–∏–Ω–∞:** Redis –Ω–µ –∑–∞–ø—É—â–µ–Ω  
**–†–µ—à–µ–Ω–∏–µ:** –ó–∞–ø—É—Å—Ç–∏—Ç–µ –æ–∫–Ω–æ REDIS SERVER

---

### ‚ùå "ImportError: cannot import name 'cached_download'"
```
ImportError: cannot import name 'cached_download' from 'huggingface_hub'
```
**–ü—Ä–∏—á–∏–Ω–∞:** –ù–µ—Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å –±–∏–±–ª–∏–æ—Ç–µ–∫  
**–†–µ—à–µ–Ω–∏–µ:** 
```powershell
cd C:\fns_bot\fanslymotion
.\venv\Scripts\Activate.ps1
pip install --upgrade huggingface-hub diffusers
```

---

### ‚ùå "OSError: [WinError 1114] DLL initialization failed"
```
OSError: [WinError 1114] A dynamic link library (DLL) initialization routine failed
```
**–ü—Ä–∏—á–∏–Ω–∞:** –ü—Ä–æ–±–ª–µ–º–∞ —Å PyTorch  
**–†–µ—à–µ–Ω–∏–µ:** –ü–µ—Ä–µ—É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ PyTorch:
```powershell
pip uninstall torch torchvision -y
pip install torch torchvision --index-url https://download.pytorch.org/whl/cu121
```

---

### ‚ùå "CUDA out of memory"
```
RuntimeError: CUDA out of memory
```
**–ü—Ä–∏—á–∏–Ω–∞:** –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ VRAM –Ω–∞ GPU  
**–†–µ—à–µ–Ω–∏–µ:** 
1. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –º–µ–Ω—å—à–µ–µ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ (360p –∏–ª–∏ 480p)
2. –ó–∞–∫—Ä–æ–π—Ç–µ –¥—Ä—É–≥–∏–µ –ø—Ä–æ–≥—Ä–∞–º–º—ã, –∏—Å–ø–æ–ª—å–∑—É—é—â–∏–µ GPU
3. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ Worker

---

## üìà –ö–∞–∫ —Å–ª–µ–¥–∏—Ç—å –∑–∞ –ø—Ä–æ–≥—Ä–µ—Å—Å–æ–º –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏?

### –í Telegram –±–æ—Ç–µ:
```
‚úÖ Job created!
üÜî Job ID: 33e500af-724a-454d-9b66-455f76bfcb06
üìä Queue position: 1

‚è≥ Starting processing...

üé¨ Generating video...
[‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñë‚ñë] 80%

‚úÖ Your video is ready!
[–û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –≤–∏–¥–µ–æ]
```

### –í –æ–∫–Ω–µ RQ WORKER:
- –°–º–æ—Ç—Ä–∏—Ç–µ –Ω–∞ —Å—Ç—Ä–æ–∫–∏ —Å –ø—Ä–æ—Ü–µ–Ω—Ç–∞–º–∏
- –ò—â–∏—Ç–µ "Downloading" - –∑–Ω–∞—á–∏—Ç —Å–∫–∞—á–∏–≤–∞–µ—Ç—Å—è
- –ò—â–∏—Ç–µ "Generating" - –∑–Ω–∞—á–∏—Ç —Å–æ–∑–¥–∞—ë—Ç –≤–∏–¥–µ–æ
- –ò—â–∏—Ç–µ "‚úÖ" - –∑–Ω–∞—á–∏—Ç –≥–æ—Ç–æ–≤–æ

---

## üîÑ –ö–∞–∫ –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å Worker, –µ—Å–ª–∏ —á—Ç–æ-—Ç–æ –ø–æ—à–ª–æ –Ω–µ —Ç–∞–∫?

### –í–∞—Ä–∏–∞–Ω—Ç 1: –ó–∞–∫—Ä—ã—Ç—å –æ–∫–Ω–æ –∏ –∑–∞–ø—É—Å—Ç–∏—Ç—å –∑–∞–Ω–æ–≤–æ
1. –ó–∞–∫—Ä–æ–π—Ç–µ –æ–∫–Ω–æ "RQ WORKER"
2. –û—Ç–∫—Ä–æ–π—Ç–µ –Ω–æ–≤—ã–π PowerShell
3. –í—ã–ø–æ–ª–Ω–∏—Ç–µ:
```powershell
cd C:\fns_bot\fanslymotion
.\venv\Scripts\Activate.ps1
python worker/worker.py
```

### –í–∞—Ä–∏–∞–Ω—Ç 2: –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —á–µ—Ä–µ–∑ Task Manager
1. Ctrl+Shift+Esc
2. –ù–∞–π–¥–∏—Ç–µ `python.exe` (3-4 –ø—Ä–æ—Ü–µ—Å—Å–∞)
3. –ó–∞–≤–µ—Ä—à–∏—Ç–µ –≤—Å–µ
4. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –∑–∞–Ω–æ–≤–æ —á–µ—Ä–µ–∑ `run_local_clean.ps1`

---

## üí° –ü–æ–ª–µ–∑–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏

### –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ Redis —Ä–∞–±–æ—Ç–∞–µ—Ç:
```powershell
cd C:\Redis-x64-3.0.504
.\redis-cli.exe ping
# –î–æ–ª–∂–Ω–æ –≤–µ—Ä–Ω—É—Ç—å: PONG
```

### –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —Å–∫–æ–ª—å–∫–æ –∑–∞–¥–∞—á –≤ –æ—á–µ—Ä–µ–¥–∏:
```powershell
.\redis-cli.exe llen rq:queue:svd_jobs
# 0 = –ø—É—Å—Ç–æ, 1+ = –µ—Å—Ç—å –∑–∞–¥–∞—á–∏
```

### –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å –∑–∞–¥–∞—á–∏:
```powershell
.\redis-cli.exe get "job:–í–ê–®_JOB_ID:metadata"
# –ü–æ–∫–∞–∂–µ—Ç JSON —Å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –æ –∑–∞–¥–∞—á–µ
```

### –ü—Ä–æ–≤–µ—Ä–∏—Ç—å Backend:
```powershell
curl http://127.0.0.1:8000/health
# –î–æ–ª–∂–Ω–æ –≤–µ—Ä–Ω—É—Ç—å: {"status":"healthy","redis":"connected"}
```

### –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, –∑–∞–ø—É—â–µ–Ω—ã –ª–∏ Python –ø—Ä–æ—Ü–µ—Å—Å—ã:
```powershell
Get-Process python | Where-Object { $_.Path -like "*fanslymotion*" }
# –î–æ–ª–∂–Ω–æ –ø–æ–∫–∞–∑–∞—Ç—å 2-3 –ø—Ä–æ—Ü–µ—Å—Å–∞
```

---

## üéØ –ß–µ–∫-–ª–∏—Å—Ç –ø–µ—Ä–µ–¥ –≥–µ–Ω–µ—Ä–∞—Ü–∏–µ–π –≤–∏–¥–µ–æ

- [ ] 4 –æ–∫–Ω–∞ PowerShell –æ—Ç–∫—Ä—ã—Ç—ã (Redis, Backend, Bot, Worker)
- [ ] –í –æ–∫–Ω–µ Worker –Ω–∞–ø–∏—Å–∞–Ω–æ "Connected to Redis"
- [ ] Backend –æ—Ç–≤–µ—á–∞–µ—Ç –Ω–∞ /health (status: healthy)
- [ ] –ë–æ—Ç –æ—Ç–≤–µ—á–∞–µ—Ç –Ω–∞ /start
- [ ] –ï—Å—Ç—å —Ö–æ—Ç—è –±—ã 20 –ì–ë —Å–≤–æ–±–æ–¥–Ω–æ–≥–æ –º–µ—Å—Ç–∞ –Ω–∞ –¥–∏—Å–∫–µ C:
- [ ] –ò–Ω—Ç–µ—Ä–Ω–µ—Ç —Ä–∞–±–æ—Ç–∞–µ—Ç (–¥–ª—è –ø–µ—Ä–≤–æ–≥–æ —Ä–∞–∑–∞)

---

## üìû –ß—Ç–æ –¥–µ–ª–∞—Ç—å, –µ—Å–ª–∏ –Ω–∏—á–µ–≥–æ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç?

1. **–ü–æ—Å–º–æ—Ç—Ä–∏—Ç–µ –Ω–∞ –æ–∫–Ω–æ RQ WORKER** - —Ç–∞–º –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –æ—à–∏–±–∫–∏
2. **–°–¥–µ–ª–∞–π—Ç–µ —Å–∫—Ä–∏–Ω—à–æ—Ç –æ—à–∏–±–∫–∏**
3. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –≤—Å–µ 4 –æ–∫–Ω–∞ –æ—Ç–∫—Ä—ã—Ç—ã**
4. **–ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ –≤—Å—ë:**
   ```powershell
   # –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –≤—Å—ë
   Get-Process python,redis-server -ErrorAction SilentlyContinue | Stop-Process -Force
   
   # –ó–∞–ø—É—Å—Ç–∏—Ç—å –∑–∞–Ω–æ–≤–æ
   cd C:\fns_bot\fanslymotion
   .\run_local_clean.ps1
   ```

---

–¢–µ–ø–µ—Ä—å –≤—ã –∑–Ω–∞–µ—Ç–µ, –∫–∞–∫ —Å–ª–µ–¥–∏—Ç—å –∑–∞ —Ä–∞–±–æ—Ç–æ–π —Å–∏—Å—Ç–µ–º—ã! üìä

